# Изменения: Бессрочные токены привязки

## Что изменилось

Токены привязки устройств теперь **бессрочные** вместо временных с истечением срока действия.

## Измененные файлы

### 1. qr-schemas.ts

- **TokenBasedDeviceQRSchema**: Убрано поле `exp` (expiration timestamp)
- **GenerateDeviceQRSchema**: Убрано поле `tokenExpirationDays`
- **GenerateDeviceQRResponseSchema**: Убрано поле `tokenExpiresAt`
- **ValidationResultSchema**: Убрано поле `isExpired`

### 2. device-contracts.ts и qr-contracts.ts

- Убран код ошибки `EXPIRED_TOKEN` из enum ошибок привязки
- Остались только: `INVALID_QR`, `DEVICE_NOT_FOUND`

### 3. device-schemas.ts

- **AdminDeviceSchema**: Поле `bindingTokenExpiresAt` стало опциональным с описанием "(null для бессрочных токенов)"

### 4. QR_OPTIMIZATION.md

- Обновлены примеры QR-кодов (убрано поле `exp`)
- Обновлены размеры QR-кодов (80-90 символов вместо 90-100)
- Обновлены описания преимуществ токен-подхода
- Убраны упоминания временных токенов и истечения срока действия

## Преимущества бессрочных токенов

### ✅ Для производства

- Устройства можно производить заранее без беспокойства об истечении токенов
- Упрощенная логика производственного процесса
- Нет необходимости перепечатывать QR-коды

### ✅ Для пользователей

- QR-код остается действительным до момента привязки
- Нет проблем с "просроченными" устройствами
- Упрощенный процесс привязки

### ✅ Для разработчиков

- Упрощенная логика валидации
- Меньше edge cases для обработки
- Компактнее QR-коды

## Безопасность

Токены остаются **одноразовыми**:

1. Генерируются при производстве
2. Действительны до первой успешной привязки
3. Становятся недействительными после привязки
4. Можно отозвать административно

## Миграция

Существующие системы должны:

1. Обновить схемы валидации (убрать проверку `exp`)
2. Обновить обработку ошибок (убрать `EXPIRED_TOKEN`)
3. Обновить UI (убрать сообщения об истечении)
4. Обновить документацию API

## Обратная совместимость

⚠️ **Breaking change**: Существующие QR-коды с полем `exp` не будут работать с новыми схемами.

Рекомендация: Переход выполнять поэтапно с предварительным уведомлением пользователей.
